<Window x:Class="TextDictionaryReplacer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TextDictionaryReplacer" 
        xmlns:dictionaries="clr-namespace:TextDictionaryReplacer.Dictionaries" 
        xmlns:replacing="clr-namespace:TextDictionaryReplacer.Replacing"
        xmlns:attached="clr-namespace:TextDictionaryReplacer.AttachedProperties"
        xmlns:Converters="clr-namespace:TextDictionaryReplacer.Converters"
        mc:Ignorable="d"
        Title="Text Replacer" 
        Height="720" Width="1280"
        Style="{DynamicResource CustomWindowStyle}">
    <Window.Resources>
        <Converters:IsSearchingToStartStopConverter x:Key="IsSearchingToStartStopConverter"/>
        <Converters:IsSearchingToColourConverter x:Key="IsSearchingToColourConverter"/>
    </Window.Resources>
    <Grid Margin="5">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="12*"/>
                <ColumnDefinition Width="30*"/>
            </Grid.ColumnDefinitions>
            <GroupBox DataContext="{Binding Dictionary, UpdateSourceTrigger=PropertyChanged}">
                <GroupBox.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Dictionary" VerticalAlignment="Center"/>
                        <Separator Style="{DynamicResource VerticalSeparator}" Margin="5 0"/>
                        <Border HorizontalAlignment="Right" VerticalAlignment="Top" Width="18" Height="18" 
                                Background="{DynamicResource ControlDarkerBackground}" 
                                BorderThickness="1" BorderBrush="{DynamicResource ControlDefaultBorderBrush}"
                                ToolTipService.ShowDuration="150000">
                            <Border.ToolTip>
                                <TextBlock Text="A dictionary is basically two lists, one called the Key and one called the Value. A (string) Key might be 'Cat Name' and the value could be (string) 'Daisy'. This program will replace the Key with the Value, in the text on the right side. So if you're a programmer trying to deobfuscate code for example, the Key might be 'function_3895b' and the Value might be 'DoSomeTask'"
                                           TextWrapping="Wrap"/>
                            </Border.ToolTip>
                            <TextBlock Text="?" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </StackPanel>
                </GroupBox.Header>
                <Grid>
                    <GroupBox Header="Add Key and Values" Height="129" VerticalAlignment="Top">
                        <Grid>
                            <Label Content="Replace" HorizontalAlignment="Left" VerticalAlignment="Top"/>
                            <TextBox Text="{Binding Replace, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Top" HorizontalAlignment="Stretch" Margin="56,0,0,0" VerticalContentAlignment="Center" Padding="4"/>
                            <Label Content="With" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,29,0,0"/>
                            <TextBox Text="{Binding With, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Top" HorizontalAlignment="Stretch" Margin="56,29,0,0" VerticalContentAlignment="Center" Padding="4"/>
                            <Button Command="{Binding AddKeyPairCommand, Mode=OneTime}" Content="Add" Margin="0,58,0,0"/>
                        </Grid>
                    </GroupBox>
                    <GroupBox Margin="0,132,0,136">
                        <GroupBox.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Dictionary Pairs" VerticalAlignment="Center"/>
                                <Separator Style="{DynamicResource VerticalSeparator}" Margin="5 0"/>
                                <CheckBox IsChecked="{Binding CaseSensitive, UpdateSourceTrigger=PropertyChanged}" Content="Case Sensitive" Background="{DynamicResource ControlBrightDefaultBackground}" BorderBrush="{DynamicResource ControlBrightDefaultBorderBrush}"/>
                            </StackPanel>
                        </GroupBox.Header>
                        <Grid>
                            <ListBox ItemsSource="{Binding DictionaryItems, Mode=OneTime}"
                                     HorizontalContentAlignment="Stretch"
                                     ScrollViewer.CanContentScroll="False"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled" 
                                     BorderBrush="{DynamicResource ControlDefaultBorderBrush}" 
                                     Margin="0,0,0,38">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <dictionaries:DictionaryPairControl DataContext="{Binding}"/>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <Button Command="{Binding ClearAllPairsCommand, Mode=OneTime}" 
                                    Content="Clear" 
                                    VerticalAlignment="Bottom" 
                                    Height="35"/>
                        </Grid>
                    </GroupBox>
                    <GroupBox Header="Load from File" VerticalAlignment="Bottom" Height="133">
                        <Grid>
                            <Label Content="Path" VerticalAlignment="Top" HorizontalAlignment="Left"/>
                            <TextBox Text="{Binding LoadFilePath, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Top" HorizontalAlignment="Stretch" Margin="38,0,24,0" VerticalContentAlignment="Center" Padding="4"/>
                            <Button Content="..." Command="{Binding ShowSearchFilePathCommand, Mode=OneTime}" BorderThickness="0 1 1 1" Height="26" VerticalAlignment="Top" HorizontalAlignment="Right" Width="24"/>

                            <Separator Margin="0,29,0,0" Height="1" VerticalAlignment="Top"/>

                            <Label Content="Key and Value separator character" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0,33,0,0"/>
                            <TextBox Text="{Binding KeyValueSeparator, UpdateSourceTrigger=PropertyChanged}" 
                                     VerticalAlignment="Top" 
                                     HorizontalAlignment="Stretch" 
                                     Margin="193,33,19,0" 
                                     VerticalContentAlignment="Center" 
                                     Padding="4" MaxLength="1"/>
                            <Border HorizontalAlignment="Right" VerticalAlignment="Top" Width="19" Height="26" 
                                    Background="{DynamicResource ControlDarkerBackground}" 
                                    BorderThickness="0 1 1 1" BorderBrush="{DynamicResource ControlDefaultBorderBrush}"
                                    ToolTipService.ShowDuration="5000" Margin="0,33,0,0">
                                <Border.ToolTip>
                                    <TextBlock Text="The character which separate the Keys from the Values. This is normally a whitespace ( )."
                                               TextWrapping="Wrap"/>
                                </Border.ToolTip>
                                <TextBlock Text="?" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>

                            <Button Command="{Binding LoadDictionaryFromPathCommand, Mode=OneTime}" IsEnabled="{Binding IsNotLoadingDictionaryFromFile, UpdateSourceTrigger=PropertyChanged}" Content="Load" Margin="0,62,0,0"/>
                        </Grid>
                    </GroupBox>
                </Grid>
            </GroupBox>

            <GroupBox Header="Replacing" DataContext="{Binding Replacing, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Margin="3,0,0,0">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="2*"/>
                    </Grid.ColumnDefinitions>
                    <GroupBox Header="Files" Margin="0,0,0,153">
                        <Grid>
                            <Button Command="{Binding OpenFileCommand, Mode=OneTime}" Content="Open and Add a File" VerticalAlignment="Top" 
                                    HorizontalAlignment="Stretch" 
                                    Height="32"/>
                            <Border Margin="0,35,0,0" Height="35" VerticalAlignment="Top"
                                    BorderThickness="1" BorderBrush="{DynamicResource ControlDefaultBorderBrush}" Background="{DynamicResource ContainerBackground}">
                                <Grid>
                                    <Button Command="{Binding OpenFolderCommand, Mode=OneTime}" Content="Open all Files in a Folder" 
                                            HorizontalAlignment="Stretch" Margin="0,0,85,0"
                                            BorderThickness="0 0 1 0"/>
                                    <CheckBox IsChecked="{Binding SearchRecursively, UpdateSourceTrigger=PropertyChanged}" Content="Search&#xA;Recursively" HorizontalAlignment="Right" Width="82" Height="Auto"/>
                                </Grid>
                            </Border>
                            <ListBox ItemsSource="{Binding Files, Mode=OneTime}"
                                     SelectedItem="{Binding SelectedFile, UpdateSourceTrigger=PropertyChanged}"
                                     HorizontalContentAlignment="Stretch"
                                     ScrollViewer.CanContentScroll="False"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled" 
                                     BorderBrush="{DynamicResource ControlDefaultBorderBrush}" 
                                     Margin="0,73,0,38">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <replacing:FileControl DataContext="{Binding}"/>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <Button Command="{Binding ClearFilesCommand, Mode=OneTime}" 
                                    Content="Clear" 
                                    VerticalAlignment="Bottom" 
                                    Height="35"/>
                        </Grid>
                    </GroupBox>
                    <GroupBox Header="Search and Replace" Height="150" VerticalAlignment="Bottom">
                        <Grid>
                            <Button Content="{Binding IsSearching, Converter={StaticResource IsSearchingToStartStopConverter}, UpdateSourceTrigger=PropertyChanged}" 
                                    Command="{Binding AutoStartSearchCommand, Mode=OneTime}"
                                    FontSize="20" 
                                    HorizontalAlignment="Stretch" 
                                    Margin="0,55,0,0" 
                                    Background="{Binding IsSearching, Converter={StaticResource IsSearchingToColourConverter}, UpdateSourceTrigger=PropertyChanged}"/>
                            <Label Content="Will search through" Padding="5 5 4 5" HorizontalAlignment="Left" VerticalAlignment="Top"/>
                            <StackPanel Orientation="Horizontal" Margin="112,0,0,0" Height="26" VerticalAlignment="Top">
                                <Label Content="{Binding Files.Count, FallbackValue=0, UpdateSourceTrigger=PropertyChanged}" Padding="0 5 4 5"/>
                                <Label Content="Files" Padding="0 5 5 5"/>
                            </StackPanel>
                            <Label Content="For" Padding="5 5 4 5" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,26,0,0"/>
                            <StackPanel Orientation="Horizontal" Margin="26,26,0,0" Height="26" VerticalAlignment="Top">
                                <Label Content="{Binding Dictionary.DictionaryItems.Count, UpdateSourceTrigger=PropertyChanged}" Padding="0 5 4 5"/>
                                <Label Content="Keys to be replaced" Padding="0 5 5 5"/>
                            </StackPanel>
                        </Grid>
                    </GroupBox>
                    <GroupBox DataContext="{Binding SelectedFile, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Margin="3,0,0,0">
                        <GroupBox.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Selected File"/>
                                <Separator Style="{DynamicResource VerticalSeparator}" Margin="5 0"/>
                                <TextBlock Text="Name: "/>
                                <TextBlock Text="{Binding FileName, FallbackValue=(no file selected), UpdateSourceTrigger=PropertyChanged}"/>
                                <TextBlock Text="   -   Size: "/>
                                <TextBlock Text="{Binding FileSize, FallbackValue=(no file selected), UpdateSourceTrigger=PropertyChanged}"/>
                            </StackPanel>
                        </GroupBox.Header>
                        <Grid>
                            <TextBox TextWrapping="NoWrap"
                                     Text="{Binding Text, UpdateSourceTrigger=PropertyChanged}"
                                     FontFamily="Consolas"
                                     attached:HorizontalScrolling.UseHorizontalScrolling="True"
                                     ScrollViewer.CanContentScroll="False"
                                     HorizontalScrollBarVisibility="Visible"
                                     VerticalScrollBarVisibility="Visible"
                                     BorderThickness="1"
                                     Focusable="True" 
                                     Visibility="Visible"
                                     Language="en"
                                     UndoLimit="1000"
                                     AutoWordSelection="False"
                                     IsInactiveSelectionHighlightEnabled="True"
                                     AcceptsReturn="True"
                                     AcceptsTab="True"
                                     />
                        </Grid>
                    </GroupBox>
                </Grid>
            </GroupBox>
        </Grid>
    </Grid>
</Window>
